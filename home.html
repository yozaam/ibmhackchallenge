
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Post COVID Bus Transport Safety Management</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">  
  <script src="https://kit.fontawesome.com/4e179a99ad.js" crossorigin="anonymous"></script>
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
  <title>Bootstrap 4 Modal</title>
<!-- <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
 -->
  <style>
      .bs-example{
          margin: 20px;        
      }
      .title{
        text-align: center;
        width: 100%;
        background-color: black;
        color:whitesmoke;
      }
      .stops{
        margin-top: 5%;
        width: 80%;
      }
      .bs-example{
        margin: 20px;        
      }
      /* Adding space at the bottom of progress bar */
      .progress{
          margin-bottom: 1rem;
      }
      .btn-danger{
        padding-bottom: 15% auto 15% auto;
      }
      .fafa{
        text-align: center;
      }
      .selected{
        border: 2px solid #28a745;
        border-radius: 5%;
      }

  </style>
 <!--  <script>
  $("#report").click(function(){
    $("#myModal").modal('show');
  });
</script> -->
</head>

<body class="homepage" style="width:100%">

  
 <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <a class="navbar-brand" href="#">Public Transit Management Post Covid-19</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav">
        <li class="nav-item active">
          <a class="nav-link" href="./home.html">Reports </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="./mappage.html">Map <span class="sr-only">(current)</span></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="./contact.html">About <span class="sr-only">(current)</span></a>
        </li>
      </ul>
    </div>
  </nav>


 <!--  <div class="title container">
    <h1>Post COVID Bus Transport Safety Management</h1>

  </div> -->

  <div class="container stops">
    <h2>Bus Route Risk Factors</h2>
    <div class="progress">
      
      <div class="progress-bar bg-success" style="width: 0%" id="pjuhu">
          Safe (Juhu)
      </div>
      <div class="progress-bar bg-warning" style="width: 0%" id="psantacruz">
          Low Risk (Santacruz)
      </div>
      <div class="progress-bar bg-danger" style="width: 0%" id="pbandra">
          High Risk (Bandra)
      </div>
    </div>


    <div class="stops container">
      <h2>Individual Bus Stop Risk Factors</h2>
      <div class="progress">
          <div class="progress-bar progress-bar-striped bg-success" style="width: 0%" id="juhu">
            Juhu
          </div>
      </div>
      <div class="progress">
          <div class="progress-bar progress-bar-striped bg-warning" style="width: 0%" id="santacruz">
            Santacruz
          </div>
      </div>
      <div class="progress">
          <div class="progress-bar progress-bar-striped bg-danger" id="bandra" style="width: 0%">
            Bandra
          </div>
      </div>
    </div>
    
    <script>
      // For animating the progress bars
      $(document).ready(function(){


        

        window.stop = "juhu";

        
        $('#juhu').animate({width: "35%"},10000);
        $('#pjuhu').animate({width: "40%"},10000);



        setTimeout(function(){ 

                window.stop = "santacruz";
                $('#santacruz').animate({width: "80%"},10000);
                $('#psantacruz').animate({width: "25%"},10000);
             }, 15000);
      


        });



        setTimeout(function(){  

            window.stop="bandra";
            $('#bandra').animate({width: "100%"},10000);
            $('#pbandra').animate({width: "15%"},10000);


        }, 30000);
        
    </script>

    <!-- this is all list code , html css ,ssjs

     -->
    <div class="table">
      <table class="table">
      <thead>
        <tr>
          <th scope="col">#</th>
          <th scope="col">Location</th>
          <th scope="col">Reported Cough</th>
          <th scope="col">Not Wearing Mask</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th scope="row">1</th>
          <td>Juhu</td>
          <td> <i id="jcough">3</i>:  
            <i class="fas fa-head-side-cough"></i>
          </td>
          <td> <i id="jmask">4</i>:  
            <i class="fas fa-head-side-mask"></i>
          </td>
        </tr>
        <tr>
          <th scope="row">2</th>
          <td>Santacruz</td>
          <td> <i id="scough">3</i>:  
            <i class="fas fa-head-side-cough"></i>
          </td>
          <td> <i id="smask">4</i>:  
            <i class="fas fa-head-side-mask"></i>
          </td>
        </tr>
        <tr>
          <th scope="row">3</th>
          <td>Bandra</td>
          <td> <i id="bcough">3</i>:  
            <i class="fas fa-head-side-cough"></i>
          </td>
          <td> <i id="bmask">4</i>:  
            <i class="fas fa-head-side-mask"></i>
          </td>
        </tr>
      </tbody>
    </table>
    </div>

    <!-- END of list -->

    <div class="report fixed-bottom">
      <button type="button" class="btn btn-lg btn-block btn-danger " data-toggle="modal" data-target="#myModal" id=report>Report</button>
    </div>
  
  </div>




  <!-- POPUP -->
 <div class="bs-example">
      <div id="myModal" class="modal fade" tabindex="-1">
          <div class="modal-dialog">
              <div class="modal-content">
                  <div class="modal-header">
                      <h5 class="modal-title">Report ( Cough | No Mask )</h5>
                      <button id="cross" type="button" class="close" data-dismiss="modal">&times;</button>
                  </div>
                  <div class="modal-body">
                    <div class="row">
                      <div class="col">
                         <img class="img-fluid" src="./mask.png" id="mask" alt="">
                      </div>
                      <div class="col">
                        <img src="./cough.png" alt="" class="img-fluid selected" id="cough">
                      </div>
                    </div> 

                    <div class="row" style="margin-top:5%">
                      <div class="col fafa" id="inside">
                         <i class="fa fa-bus fa-4x" aria-hidden="true"></i>
                         <p>Inside Bus</p>
                      </div>
                      <div class="col fafa" id="outside">
                        <i class="fa fa-hand-paper-o fa-4x" aria-hidden="true"></i>
                        <p>Bus Stop</p>
                      </div>
                    </div> 

                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-success btn-lg btn-block" id="submit">Confirm Report</button>
                  </div>
              
              </div>
          </div>
      </div>
  </div>
  <script>
    
    var mask = true;

    $("#mask").click(
        function(){
          mask = true;
           if ( $("#cough").hasClass('selected') ) {
              $("#cough").removeClass('selected') ;
           }
           $("#mask").addClass('selected') ;
        }
      );
        $("#cough").click(
        function(){
          mask = false;
           if ( $("#mask").hasClass('selected') ) {
              $("#mask").removeClass('selected') ;
           }
           $("#cough").addClass('selected') ;
        }
      );


    var outside = true;

    $("#outside").click(
        function(){
          outside = true;
           if ( $("#inside").hasClass('selected') ) {
              $("#inside").removeClass('selected') ;
           }
           $("#outside").addClass('selected') ;
        }
      );
        $("#inside").click(
        function(){
          outside = false;
           if ( $("#outside").hasClass('selected') ) {
              $("#outside").removeClass('selected') ;
           }
           $("#inside").addClass('selected') ;
        }
      );

      

      $("#submit").click(
        function(){


         var reportId = firebase.database().ref().child('reports').push().key;
 
        updateStop(window.stop,mask) 
        // writeUserData(reportId,mask,window.stop,outside);

        $("#cross").click() ;
      });

  </script>
  <!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/7.15.5/firebase-app.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
<script src="https://www.gstatic.com/firebasejs/7.15.5/firebase-database.js"></script>
<script>
  // Your web app's Firebase configuration
  var firebaseConfig = {
    apiKey: "AIzaSyAVK972bAzztxsW-OUugrm6YRqyZXmX_lQ",
    authDomain: "ibm-smart.firebaseapp.com",
    databaseURL: "https://ibm-smart.firebaseio.com",
    projectId: "ibm-smart",
    storageBucket: "ibm-smart.appspot.com",
    messagingSenderId: "295309881685",
    appId: "1:295309881685:web:d5fce9b873c68fa78fffdc"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  // Get a reference to the database service
  var database = firebase.database().ref('stops');
  

  function updateStop(stop,mask) {

    var ref = 'stops/'+stop+'/';
    if(mask){
      ref = ref+'mask';
    }else{
      ref = ref+'cough';
    }
    var database = firebase.database().ref(ref);

    database.transaction(function(count) {
      
      return count+1;
    });
  }

// function writeUserData(reportId, mask,stop,outside) {
//   firebase.database().ref('stops/' + stop).set({
//     mask: mask,
//     outside: outside
//   });
// }

    var stopsRef = firebase.database().ref();
    stopsRef.on('value', function(snapshot) {
        snapshot = snapshot.val().stops;
      document.getElementById('bcough').innerHTML =  snapshot.bandra.cough;
      document.getElementById('bmask').innerHTML =  snapshot.bandra.mask;
      document.getElementById('scough').innerHTML =  snapshot.santacruz.cough;
      document.getElementById('smask').innerHTML =  snapshot.santacruz.mask;
      document.getElementById('jcough').innerHTML =  snapshot.juhu.cough;
      document.getElementById('jmask').innerHTML =  snapshot.juhu.mask;
    });

</script>
</body>